# For Linux / Mac

From a terminal, you should be able to `ssh unicorn.cim.mcgill.ca` to connect to unicorn. Set up [SSH keys](https://www.digitalocean.com/community/tutorials/how-to-set-up-ssh-keys-2) both for security and because it is far more convenient!

To use github while you are logged into unicorn, you will need to upload your public key to github through your github settings. However, DO NOT put your private key on unicorn so that you can `git clone` from github while on unicorn! The correct way is to use ForwardAgent in your `~/.ssh/config`. This will safely forward your private key(s) through unicorn to github. For example, my `~/.ssh/config` on my laptop contains:

```
 Host unicorn
        User <your unicorn account name>
 	HostName unicorn.cim.mcgill.ca
 	ForwardAgent yes
```

Then, from my laptop, I can `ssh unicorn`, then once I'm logged in, `git clone --recurse-submodules git@github.com:Shared-Reality-Lab/IMAGE-server.git`, and I don't have to type a password since my private key on my local computer is being forwarded to github for authentication. It might ask you to set your email address. Make sure to set it to one that is associated with your github account. At this point, you should be able to branch, make changes, and push to github, not passwords necessary!


# For Windows

If you have a Windows machine and you are having trouble connecting to Unicorn or others via SSH fear not! This a fairly common problem and we will be addressing this issue in no time. Usually, this happens because Windows does not have the SSH-agent turned on by default which won't allow you to properly leverage the "Forwarding Agent" that will allow you to clone github repos on Unicorn.

Before we get started, make sure you have the most recent version of PowerShell installed and open a window as administrator. If you haven't already, you will need to generate an SSH-key and add it to your github account, you can follow instructions [here](https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account)
This is important as it is this key that the "ForwardAgent" will use to access github. 

**IMPORTANT:** DO NOT GENERATE A KEY PRIVATE KEY ON A MACHINE YOU DO NOT OWN. 

Private keys, the ones generated by the `ssh-keygen` command, should only reside in a machine you have full control and cannot be reached by others for security reasons. You public keys, which is the one generated and saved on github is safe to use on other machines. 

Finally by following the steps found in [Practically using github while SSH'ed into a test or production server](https://github.com/Shared-Reality-Lab/IMAGE-server/wiki/3.-Creating,-testing,-and-deploying-preprocessors-and-handlers#practically-using-github-while-sshed-into-a-test-or-production-server) you should be able to access Unicorn and we are finally ready to set up our ForwardAgent. 

Prior to running the ssh-agent, you will need to update OpenSSH as the default Windows ForwardAgent does not work with Ubuntu 22+. To do this you will open Powershell as administrator and run the following commands: 

Search for the package:
* `winget search "openssh beta"`
Install new OpenSSH:
* `winget install "openssh beta"`

Now the new OpenSSH should be installed!

Incase you want to uninstall you can run this command:
* `winget uninstall "openssh beta" `


Back to setting up the SSH ForwardAgent. If the follow command:
`Get-Service ssh-agent`
Gives you a "Stopped" status for your SSH agent as seen below:

<pre><code>Status   Name               DisplayName
------   ----               -----------
Stopped  ssh-agent          OpenSSH Authentication Agent
</code></pre>

And if `Get-Service ssh-agent | Select StartType`
Shows gives the following output: 

<pre><code>StartType
---------
Disabled
</code></pre>

This means that Windows does no currently have an agent running. To activate a new SSH-Agent you will need to do the following: 
1. Set the agent to Manual activation:

`Get-Service -Name ssh-agent | Set-Service -StartupType Manual`

2. Then you activate your agent:

`Start-Service ssh-agent`

3. Add the path to your SSH-keys:

`ssh-add path\to\ssh\key`

4. Sanity check, if the following command gives you a long string of random things it worked! Otherwise it will give you a message regarding missing ssh-agents. 

`ssh-add -L`